{"name":"Nessus-analyzer","tagline":"Ruby script to analyze Nessus files and generate statistics","body":"# Tool to analyze Nessus output\r\n\r\n## Running the analyzer\r\nEvery time you run the analyzer you need to supply two options:\r\n\r\n1. The file or you want to analyze.\r\n2. The action you want to take (find top events, show stats, send to graphite, etc)\r\n\r\n```\r\nUsage: ./nessus-analyzer.rb [options] -f report.nessus \r\n  where [options] are:\r\n  --file, -f <s>:   The .nessus file you want to process\r\n  --top-events, -n <i>:   The <i> most common events\r\n  --show-statistics, -s:   Show report statistic\r\n  --graphite-server, -g <s>:   The graphite server you want to send data to\r\n  --graphite-metric, -m <s>:   The root graphite metric to send data to\r\n  --timestamp, -t <i>:   Graphite timestamp, defaults midnight of the current date.\r\n  --mongo, -d: Turn a file into a document that can be imported into mongo\r\n  --help, -h:   Show this message\r\n```\r\n\r\n## Examples\r\n### Sending data to MongoDB\r\nNessus-analyzer supports sending data to MongoDB. To do this you need to \r\nconfigure your config.yaml file.\r\n\r\n```yaml\r\ndevelopment:\r\n  server:     devmongo\r\n  port:       27017\r\n  database:   nessus\r\n  collection: scans\r\n\r\nproduction:\r\n  server:     mongo\r\n  port:       27017\r\n  database:   nessus\r\n  collection: scans\r\n```\r\n\r\nTo send data to mongo you need to specify the database ```--mongo development```\r\nand (optionally) tag your scan.\r\n\r\n```./nessus-analyzer -f report.nessus -d development -t web,dev,Linux```\r\n\r\n\r\nThe above sends data to the development database and tags each host in that \r\nscan with: web, dev, and Linux. Tags are useful to query on later. Tags are \r\noptional. \r\n\r\n```./Nessus-analyzer -f report.nessus -d development```\r\n\r\nThis sends the same report to the development database, but omits any tags.\r\n\r\n\r\n### Displaying scan statistics\r\n``` \r\n ./nessus-analyzer.rb -f report.nessus -s\r\n +------------------------------------------+---------------+\r\n |                   SCAN TITLE GOES HERE                   |\r\n +------------------------------------------+---------------+\r\n | Total hosts                              |           826 |\r\n | High severity issues                     |          1547 |\r\n | Medium severity issues                   |          7475 |\r\n | Low severity isseus                      |          1576 |\r\n +------------------------------------------+---------------+\r\n | CVSS / host                              |         58.67 |\r\n | Ports / host                             |         12.00 |\r\n | % Hosts with a high severity issue       |        88.01% |\r\n | Events per host                          |         12.83 |\r\n +------------------------------------------+---------------+\r\n```\r\n### Running stats and sending them to [ Graphite ](http://graphite.wikidot.com/)\r\n```\r\n./nessus-analyzer.rb -f report.nessus -s -g devgraphite -m stats.security.prodweb\r\n```\r\n\r\n## Dependencies\r\n* [ ruby-nessus ](https://github.com/mephux/ruby-nessus)\r\n* [mongo-ruby-driver](https://github.com/mongodb/mongo-ruby-driver)\r\n* [terminal-table](https://github.com/visionmedia/terminal-table)\r\n* [bson_ext](https://rubygems.org/gems/bson_ext) - *not actually required, but significant perfornamce penalties witout it.*\r\n\r\n## Contributing\r\n* I would love your help. Features, tests, documentation, bug reporting, etc.\r\nReally, I would love it.\r\n* Fork the project. Generally I think [Scott Chacon]\r\n(http://scottchacon.com/2011/08/31/github-flow.html) offers good advice on the\r\nsubject.\r\n* Make a topic branch.\r\n* Squash your commits.\r\n* Add tests for it. This is important so I don't break it in a\r\n  future version unintentionally. (I realize there are no tests now, the irony\r\n  isn't lost on me).\r\n* Don't edit the version, tags, or history.\r\n* Send me a pull request. \r\n\r\n:beers:\r\n","google":"UA-41573678-1","note":"Don't delete this file! It's used internally to help with page regeneration."}